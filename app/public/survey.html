<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Surrvey</title>


  <script
        src="https://code.jquery.com/jquery-3.3.1.min.js"
        integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
        crossorigin="anonymous"></script>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
    <!-- Latest compiled and minified JavaScript -->

  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
  </head>
  <body>



    <!-- Modal -->
    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">

            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            
            <h4 class="modal-title" id="myModalLabel">Your new friend</h4>
          </div>
          <div class="modal-body">

          </div>
        </div>
      </div>
    </div>




<div class="container">

<h1>Answer some questions and find a friend</h1>

<button id="home" type="submit" name="button">Home Page</button>


<!--<form> -->
<h3>I like walking</h3>
  <select id="q1" name="">
    <option value="1">100% Disagree</option>
    <option value="2">Sort of Disagree</option>
    <option value="3">I'm in the Middle</option>
    <option value="4">Sort of agree</option>
    <option value="5">100% Agree</option>
  </select>
<h3>I like yogurt</h3>
<select id="q2" name="">
  <option value="1">100% Disagree</option>
  <option value="2">Sort of Disagree</option>
  <option value="3">I'm in the Middle</option>
  <option value="4">Sort of agree</option>
  <option value="5">100% Agree</option>
</select>
<h3>I like dogs and cats</h3>
<select id="q3" name="">
  <option value="1">100% Disagree</option>
  <option value="2">Sort of Disagree</option>
  <option value="3">I'm in the Middle</option>
  <option value="4">Sort of agree</option>
  <option value="5">100% Agree</option>
</select>
<h3>I like cats only</h3>
<select id="q4" name="">
  <option value="1">100% Disagree</option>
  <option value="2">Sort of Disagree</option>
  <option value="3">I'm in the Middle</option>
  <option value="4">Sort of agree</option>
  <option value="5">100% Agree</option>
</select>
<h3>I like running</h3>
<select id="q5" name="">
  <option value="1">100% Disagree</option>
  <option value="2">Sort of Disagree</option>
  <option value="3">I'm in the Middle</option>
  <option value="4">Sort of agree</option>
  <option value="5">100% Agree</option>
</select>
<h3>I'm cool in traffic</h3>
<select id="q6" name="">
  <option value="1">100% Disagree</option>
  <option value="2">Sort of Disagree</option>
  <option value="3">I'm in the Middle</option>
  <option value="4">Sort of agree</option>
  <option value="5">100% Agree</option>
</select>
<h3>I like happy friends</h3>
<select id="q7" name="">
  <option value="1">100% Disagree</option>
  <option value="2">Sort of Disagree</option>
  <option value="3">I'm in the Middle</option>
  <option value="4">Sort of agree</option>
  <option value="5">100% Agree</option>
</select>
<h3>I am rich</h3>
<select id="q8" name="">
  <option value="1">100% Disagree</option>
  <option value="2">Sort of Disagree</option>
  <option value="3">I'm in the Middle</option>
  <option value="4">Sort of agree</option>
  <option value="5">100% Agree</option>
</select>
<h3>I drive slow and careful</h3>
<select id="q9" name="">
  <option value="1">100% Disagree</option>
  <option value="2">Sort of Disagree</option>
  <option value="3">I'm in the Middle</option>
  <option value="4">Sort of agree</option>
  <option value="5">100% Agree</option>
</select>
<h3>I like to fly</h3>
<select id="q10" name="">
  <option value="1">100% Disagree</option>
  <option value="2">Sort of Disagree</option>
  <option value="3">I'm in the Middle</option>
  <option value="4">Sort of agree</option>
  <option value="5">100% Agree</option>
</select>
<!--<button id="submit" type="submit" class="btn btn-primary btn-lg btn-block" name="button">Find Friend</button> -->
<button type="submit" class="btn btn-primary btn-lg btn-block" id="submit"><i class="fa fa-check-circle" aria-hidden="true"></i>
  Submit</button>
<!-- </form> -->

</div>


<script>
  var friends
  $.get('/api/friends').then(function(res){
    friends = res
  })
 document.getElementById('submit').addEventListener('click', function(e){
   e.preventDefault()
   var ChoiceValue = []
   ChoiceValue.push(parseInt(document.getElementById('q1').value))
   ChoiceValue.push(parseInt(document.getElementById('q2').value))
   ChoiceValue.push(parseInt(document.getElementById('q3').value))
   ChoiceValue.push(parseInt(document.getElementById('q4').value))
   ChoiceValue.push(parseInt(document.getElementById('q5').value))
   ChoiceValue.push(parseInt(document.getElementById('q6').value))
   ChoiceValue.push(parseInt(document.getElementById('q7').value))
   ChoiceValue.push(parseInt(document.getElementById('q8').value))
   ChoiceValue.push(parseInt(document.getElementById('q9').value))
   ChoiceValue.push(parseInt(document.getElementById('q10').value))
    // Empty array for next loop
   var arrayFriendsScores = []
   // This for loop takes all the individual friend score arrays and pushes them to one single array
   for (var i = 0; i < friends.friends.length; i++) {
       arrayFriendsScores.push(friends.friends[i].scores)
   }
   // Empty array for next loop
   var difference = []
   // This for loop goes through the array of all friends scores and compares them to my scores. After the comparison is made it pushes all the values to the difference array
   for (var j = 0; j < arrayFriendsScores.length; j++) {
     for (var i = 0; i < arrayFriendsScores[j].length; i++) {
       if (arrayFriendsScores[j][i] > ChoiceValue[i]){
          // console.log( arrayFriendsScores[j][i] + ' was greater than ' + ChoiceValues[i])
          // console.log('the diff is ', arrayFriendsScores[j][i] - ChoiceValue[i]);
          difference.push(arrayFriendsScores[j][i] - ChoiceValue[i])
       } else if (arrayFriendsScores[j][i] > ChoiceValue[i]){
          // console.log( arrayFriendsScores[j][i] + ' was less than ' + ChoiceValue[i])
          // console.log('the diff is ', ChoiceValue[i] - arrayFriendsScores[j][i])
          difference.push(ChoiceValue[i] - arrayFriendsScores[j][i])
       } else {
         // console.log( arrayFriendsScores[j][i] + ' is equal to ' + ChoiceValue[i])
         // console.log('the diff is ', 0)
         difference.push(0)
       }
     }
   }
    // clear
   var differnceSmallerArray = []
   // this divides the big difference score array back in several arrays of 10 each
   var size = 10;
   for (var i=0; i<difference.length; i+=size) {
      var smallarray = difference.slice(i,i+size);
      differnceSmallerArray.push(smallarray)
   }
    // clear
    var sumDiffs = []
    // Sum each of the smaller arrays for a total difference for each person and push into sumDiffs
    for (var i = 0; i < differnceSmallerArray.length; i++) {
      function getSum(total, num) {
          return total + num;
      }
      sumDiffs.push(differnceSmallerArray[i].reduce(getSum))
    }
    console.log(sumDiffs);
    // most similar
    var index = 0;
    var value = sumDiffs[0];
    for (var i = 1; i < sumDiffs.length; i++) {
      if (sumDiffs[i] < value) {
        value = sumDiffs[i];
        index = i;
      }
    }
    // Empty array for next loop
    var chosenFriend = []
    //loop and push friend to array for index from last step
    chosenFriend.push(friends.friends[index])
    console.log(`smallest is ${value} and the index is ${index}`);
    console.log(chosenFriend[0]);
   $('.modal-body').html(
     `
    <h1>${chosenFriend[0].name}</h1>
    <img src="${chosenFriend[0].photo}">
     `
   )
   $('#myModal').modal()
 })
 document.getElementById('home').addEventListener('click', function(){
   location.href = '.'
 })
</script>

<!--
<style>
  #submit{
    display: block;
    margin-top: 40px;
  }
</style> -->

</body>
</html>